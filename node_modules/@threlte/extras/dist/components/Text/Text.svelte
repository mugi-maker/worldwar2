<script>import { forwardEventHandlers, T, useThrelte } from '@threlte/core';
import { createEventDispatcher, tick } from 'svelte';
import { preloadFont, Text } from 'troika-three-text';
import { useSuspense } from '../../suspense/useSuspense';
export let font = undefined;
export let characters = undefined;
export let sdfGlyphSize = undefined;
export const ref = new Text();
const { invalidate } = useThrelte();
const dispatch = createEventDispatcher();
const component = forwardEventHandlers();
const onUpdate = async () => {
    await tick();
    ref.sync(() => {
        invalidate();
        dispatch('sync');
    });
};
$: $$restProps && onUpdate();
const suspend = useSuspense();
$: suspend(new Promise((res) => preloadFont({ font, characters, sdfGlyphSize }, res)));
</script>

<T
  is={ref}
  let:ref
  {...$$restProps}
  {font}
  {characters}
  {sdfGlyphSize}
  bind:this={$component}
>
  <slot {ref} />
</T>
