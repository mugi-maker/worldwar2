<script context="module"></script>

<script>
	import * as pluginModule from '@kitschpatrol/tweakpane-plugin-essentials';
	import GenericSlider from '../internal/GenericSlider.svelte';
	export let value;
	export let meanValue = void 0;
	export let wide = void 0;
	let internalValue;
	function updateInternalValue() {
		if (Array.isArray(value)) {
			const [min, max] = value;
			internalValue = { min, max };
		} else {
			internalValue = value;
		}
	}
	function updateValue() {
		if (Array.isArray(value)) {
			const { min, max } = internalValue;
			value = [min, max];
		} else {
			value = internalValue;
		}
	}
	function updateValueFromMean() {
		if (meanValue !== void 0) {
			const r = internalValue.max - internalValue.min;
			internalValue = { min: meanValue - r / 2, max: meanValue + r / 2 };
		}
	}
	let ref;
	function updateWide(wide2) {
		const inputField = ref?.element.querySelector('div.tp-rsltxtv_t');
		if (wide2) {
			inputField?.style.setProperty('display', 'none');
		} else {
			inputField?.style.removeProperty('display');
		}
	}
	$: ref && wide !== void 0 && updateWide(wide);
	$: value, updateInternalValue();
	$: internalValue, updateValue();
	$: meanValue = (internalValue.min + internalValue.max) / 2;
	$: meanValue, updateValueFromMean();
</script>

<GenericSlider
	bind:value={internalValue}
	bind:ref
	on:change
	plugin={pluginModule}
	{...$$restProps}
/>
